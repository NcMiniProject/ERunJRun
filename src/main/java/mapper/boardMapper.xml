<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardSQL">
	<!-- Oracle <insert id="boardWrite" parameterType="java.util.Map"> INSERT 
		INTO board (seq, id, name, email, subject, content, ref) VALUES (seq_board.NEXTVAL, 
		#{id}, #{name}, #{email}, #{subject}, #{content}, seq_board.CURRVAL) </insert> -->

	<!-- MySQL -->
	<insert id="boardWrite" parameterType="board"
		useGeneratedKeys="true" keyProperty="seq">
		INSERT INTO run_board(id, email, subject, content)
		VALUES(#{id},#{email}, #{subject}, #{content})
	</insert>

 	<update id="refUpdate">
		update board set ref=LAST_INSERT_ID() where seq=LAST_INSERT_ID()
	</update> 

	<!-- 총글수 -->
	<select id="getTotalA" resultType="int">
		select count(*) from run_board
	</select>

	<!-- 목록 -->
	<select id="boardList" parameterType="java.util.Map"
		resultType="board.bean.BoardDTO">
		select * from (select rownum rn, tt.* from (select * from run_board order 
			by ref desc, step asc)tt) where rn between #{startNum} and #{endNum}
		select * from run_board order by ref desc, step asc limit #{startNum},
		#{endNum}

	</select>

	<!-- 목록 <select id="boardList" parameterType="java.util.Map" resultType="board"> 
		select * from (select rownum rn, tt.* from (select * from board order by 
		ref desc, step asc)tt )where rn between #{startNum} and #{endNum} select 
		* from (select rownum rn, tt.* from (select * from board order by ref desc, 
		step asc)tt )where rn >= #{startNum} and rn &lt;= #{endNum} <![CDATA[ select 
		* from (select rownum rn, tt.* from (select * from board order by ref desc, 
		step asc)tt )where rn >= #{startNum} and rn <= #{endNum} ]]> </select> -->
	<!-- 1개 의 글 -->

	<select id="getBoard" parameterType="int"
		resultType="board.bean.BoardDTO">
		select * from run_board where seq=#{seq}

	</select>

	<!-- 회원정보수정 -->
	<update id="boardUpdate" parameterType="java.util.Map">
		update run_board set
		subject=#{subject},
		content=#{content},
		logtime=now()
		where seq=#{seq}
	</update>
	
	<!-- 회원정보삭제  -->
	<delete id="boardDelete" parameterType="int">
 delete from run_board where seq = #{seq}
</delete>
	<!-- 조회수 -->
	<update id="hitUpdate" parameterType="int">
		update run_board set hit = hit+1 where seq=#{seq}
	</update>

</mapper>